<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Explore | PEGASUS</title>
  <link rel="stylesheet" href="css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    
    .explore-hero {
      height: 70vh;
      min-height: 500px;
      position: relative;
      overflow: hidden;
    }
    
    .explore-hero .slide {
      background-size: cover;
      background-position: center;
    }
    
    .explore-hero .slide-content {
      bottom: 100px;
      left: 40px;
      max-width: 50%;
      text-align: left;
    }
    
    .leagues-section {
      padding: 60px 0;
    }
    
    .leagues-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    
    .league-card {
      background: var(--card-bg);
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      transition: var(--transition);
      cursor: pointer;
    }
    
    .league-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }
    
    .league-logo {
      width: 80px;
      height: 80px;
      object-fit: contain;
      margin: 0 auto 15px;
    }

    .sports-leagues {
      padding: 60px 0;
      background: var(--secondary);
    }

    .leagues-scroll {
      display: flex;
      overflow-x: auto;
      gap: 20px;
      padding: 20px 0;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      position: relative;
    }

    .league-item {
      flex: 0 0 auto;
      width: 120px;
      text-align: center;
      scroll-snap-align: start;
    }

    .league-item img {
      width: 80px;
      height: 80px;
      object-fit: contain;
      margin-bottom: 10px;
    }

    .leagues-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 32px;
      height: 32px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
      z-index: 5;
    }

    .leagues-nav:hover {
      background: var(--accent);
    }

    .leagues-nav.prev {
      left: 10px;
    }

    .leagues-nav.next {
      right: 10px;
    }

    .leagues-nav i {
      font-size: 14px;
    }

    @media (max-width: 768px) {
      .explore-hero .slide-content {
        max-width: 90%;
        left: 20px;
        text-align: center;
      }
      
      .leagues-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      }

      .leagues-scroll {
        gap: 15px;
        padding: 15px 0;
      }

      .league-item {
        width: 100px;
      }

      .league-item img {
        width: 60px;
        height: 60px;
      }
      
      .leagues-nav {
        display: none;
      }
    }
  </style>
</head>
<body>
  <!-- Preloader -->
  <div id="preloader">
    <div class="preloader-content">
      <img src="images/pegasus-logo.png" alt="PEGASUS" class="preloader-logo">
      <div class="loading-circle"></div>
    </div>
  </div>

<!-- Header -->
<header>
  <div class="container">
    <nav class="navbar">
      <a href="index.html" class="logo">
        <img src="images/pegasus-logo.png" alt="PEGASUS Logo">
      </a>
      
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="explore.html">Explore</a></li>
        <li><a href="live-streams.html">Live</a></li>
        <li><a href="vod.html">VOD</a></li>
        <li><a href="highlights.html">Highlights</a></li>
        <li><a href="channels.html">Channels</a></li>
        
        <!-- Mobile Auth Buttons (Hidden on Desktop) -->
        <li class="mobile-auth-item">
          <div class="mobile-auth">
            <!-- This will be populated by JavaScript -->
          </div>
        </li>
      </ul>
      
      <!-- Desktop Auth Buttons (Hidden on Mobile) -->
      <div class="auth-buttons" id="auth-buttons">
        <!-- This will be populated by JavaScript -->
      </div>
      
      <div class="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </nav>
  </div>
</header>

  <!-- Hero Banner -->
  <section class="explore-hero">
    <div style="background-image: url('images/explore-banner.jpg');" class="slide active">
      <div class="slide-overlay"></div>
      <div class="slide-content">
        <h2>Explore All Sports</h2>
        <p>Discover live games, highlights, and channels across all categories</p>
        <a href="#featured" class="btn">Explore Now</a>
        <div class="slider-dots">
          <div class="slider-dot active"></div>
        </div>
      </div>
    </div>
    
    <div class="slider-arrows">
      <div class="arrow prev">
        <i class="fas fa-chevron-left"></i>
      </div>
      <div class="arrow next">
        <i class="fas fa-chevron-right"></i>
      </div>
    </div>
  </section>

  <!-- Promotional Banner 1 -->
  <section class="promo-banner" style="background: url('images/promo-banner-1.jpg') center/cover;">
    <div class="promo-banner-content">
      <h2 class="promo-banner-title">Premium Sports Experience</h2>
      <p class="promo-banner-subtitle">Get access to exclusive content, live events, and premium features with PEGASUS PRO</p>
      <a href="signup.html" class="btn subscribe-btn">Upgrade Now</a>
    </div>
  </section>

  <!-- Sports Leagues Scroll -->
  <section class="sports-leagues">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">Popular Leagues</h2>
      </div>
      
      <div class="leagues-scroll">
        <div class="leagues-nav prev">
          <i class="fas fa-chevron-left"></i>
        </div>
        
        <div class="league-item">
          <img src="images/premier-league.png" alt="Premier League">
          <div>Premier League</div>
        </div>
        
        <div class="league-item">
          <img src="images/nba.png" alt="NBA">
          <div>NBA</div>
        </div>
        
        <div class="league-item">
          <img src="images/uefa.png" alt="UEFA">
          <div>UEFA Champions League</div>
        </div>
        
        <div class="league-item">
          <img src="images/nfl.png" alt="NFL">
          <div>NFL</div>
        </div>
        
        <div class="league-item">
          <img src="images/formula1.png" alt="Formula 1">
          <div>Formula 1</div>
        </div>
        
        <div class="league-item">
          <img src="images/ufc.png" alt="UFC">
          <div>UFC</div>
        </div>
        
        <div class="league-item">
          <img src="images/mlb.png" alt="MLB">
          <div>MLB</div>
        </div>
        
        <div class="league-item">
          <img src="images/nhl.png" alt="NHL">
          <div>NHL</div>
        </div>
        
        <div class="leagues-nav next">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
    </div>
  </section>

  <!-- Content from Backend Section -->
  <section id="featured" class="section">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">Featured Content</h2>
        <a href="explore.html" class="view-all">View All</a>
      </div>
      
      <div class="stream-grid" id="featured-content">
        <div class="loading-placeholder">
          <div class="loading-spinner"></div>
          <p>Loading featured content...</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Promotional Banner 2 -->
  <section class="promo-banner" style="background: url('images/promo-banner-2.jpg') center/cover;">
    <div class="promo-banner-content">
      <h2 class="promo-banner-title">Never Miss a Game</h2>
      <p class="promo-banner-subtitle">Set reminders for your favorite teams and get notified before every match</p>
      <a href="signup.html" class="btn">Get Started</a>
    </div>
  </section>

  <!-- MMA Content Section -->
  <section class="section">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">MMA Content</h2>
        <a href="explore.html?category=MMA" class="view-all">View All</a>
      </div>
      
      <div class="stream-grid" id="mma-content">
        <div class="loading-placeholder">
          <div class="loading-spinner"></div>
          <p>Loading MMA content...</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Upcoming Events Section -->
  <section class="section" style="background: var(--secondary);">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">Upcoming Events</h2>
      </div>
      
      <div class="stream-grid" id="upcoming-events-container">
        <div class="loading-placeholder">
          <div class="loading-spinner"></div>
          <p>Loading upcoming events...</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
      
      <div class="copyright">
        &copy; 2026 PEGASUS Sports Streaming. All rights reserved.
      </div>
    </div>
  </footer>

  <script src="js/config.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/script.js"></script>
  <script>
    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize mobile menu
      const hamburger = document.querySelector('.hamburger');
      const navLinks = document.querySelector('.nav-links');
      
      if (hamburger && navLinks) {
        hamburger.addEventListener('click', () => {
          hamburger.classList.toggle('active');
          navLinks.classList.toggle('active');
        });
      }
      
      // Load featured content from backend
      loadFeaturedContent();
      
      // Load MMA content
      loadMMAContent();
      
      // Load upcoming events
      loadUpcomingEvents();
      
      // League items click handling
      const leagueItems = document.querySelectorAll('.league-item');
      leagueItems.forEach(item => {
        item.addEventListener('click', function() {
          const leagueName = this.querySelector('div').textContent;
          loadContentByLeague(leagueName);
        });
      });
      
      // League navigation
      const leaguesScroll = document.querySelector('.leagues-scroll');
      const leaguesNavPrev = document.querySelector('.leagues-nav.prev');
      const leaguesNavNext = document.querySelector('.leagues-nav.next');
      
      if (leaguesNavPrev && leaguesNavNext) {
        leaguesNavPrev.addEventListener('click', () => {
          leaguesScroll.scrollBy({ left: -200, behavior: 'smooth' });
        });
        
        leaguesNavNext.addEventListener('click', () => {
          leaguesScroll.scrollBy({ left: 200, behavior: 'smooth' });
        });
      }
    });
    
    // Load featured content from backend
    async function loadFeaturedContent() {
      try {
        const API_BASE = 'https://pegasus-backend.super-elmore95.workers.dev';
        const container = document.getElementById('featured-content');
        
        // Show loading state
        container.innerHTML = `
          <div class="loading-placeholder">
            <div class="loading-spinner"></div>
            <p>Loading featured content...</p>
          </div>
        `;
        
        const token = window.authManager ? window.authManager.getToken() : null;
        const headers = {
          'Content-Type': 'application/json'
        };
        
        if (token) {
          headers['Authorization'] = `Bearer ${token}`;
        }
        
        const response = await fetch(`${API_BASE}/api/content?limit=8`, { headers });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const content = await response.json();
        
        // Clear loading state
        container.innerHTML = '';
        
        // Combine all content types
        const allContent = [
          ...(content.live || []),
          ...(content.vod || []),
          ...(content.highlights || []),
          ...(content.channels || [])
        ];
        
        // Display content
        if (allContent.length === 0) {
          container.innerHTML = '<p class="no-content">No featured content available</p>';
          return;
        }
        
        // Show first 8 items
        allContent.slice(0, 8).forEach(item => {
          const isLive = item.is_live || false;
          const itemType = isLive ? 'live' : (item.type || 'vod');
          const card = document.createElement('a');
          card.href = `player.html?type=${itemType}&id=${item.id}`;
          card.className = 'stream-card';
          
          card.innerHTML = `
            <div class="card-img">
              <img src="${item.thumbnail || item.thumbnail_url || 'https://via.placeholder.com/400x225'}" 
                   alt="${item.title || item.name}" 
                   onerror="this.src='https://via.placeholder.com/400x225'">
              ${isLive ? '<div class="live-badge">LIVE</div>' : ''}
              ${item.requires_premium ? '<div class="premium-badge">PREMIUM</div>' : ''}
              <div class="card-content">
                <h3 class="card-title">${item.title || item.name}</h3>
                <div class="card-meta">
                  <span>${item.category || 'Sports'}</span>
                  <span class="card-views">${isLive ? `${item.viewers_count || 0} watching` : `${item.views_count || item.view_count || 0} views`}</span>
                </div>
              </div>
            </div>
          `;
          
          container.appendChild(card);
        });
        
      } catch (error) {
        console.error('Error loading featured content:', error);
        const container = document.getElementById('featured-content');
        container.innerHTML = '<p class="error-message">Failed to load featured content. Please try again later.</p>';
      }
    }
    
    // Load MMA content
    async function loadMMAContent() {
      try {
        const API_BASE = 'https://pegasus-backend.super-elmore95.workers.dev';
        const container = document.getElementById('mma-content');
        
        // Show loading state
        container.innerHTML = `
          <div class="loading-placeholder">
            <div class="loading-spinner"></div>
            <p>Loading MMA content...</p>
          </div>
        `;
        
        const token = window.authManager ? window.authManager.getToken() : null;
        const headers = {
          'Content-Type': 'application/json'
        };
        
        if (token) {
          headers['Authorization'] = `Bearer ${token}`;
        }
        
        // Get MMA content from backend
        const response = await fetch(`${API_BASE}/api/content?category=MMA&limit=6`, { headers });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const content = await response.json();
        
        // Clear loading state
        container.innerHTML = '';
        
        // Combine all content types
        const mmaContent = [
          ...(content.live || []),
          ...(content.vod || []),
          ...(content.highlights || []),
          ...(content.channels || [])
        ];
        
        if (mmaContent.length === 0) {
          container.innerHTML = '<p class="no-content">No MMA content available at the moment.</p>';
          return;
        }
        
        // Display MMA content
        mmaContent.slice(0, 6).forEach(item => {
          const isLive = item.is_live || false;
          const itemType = isLive ? 'live' : (item.type || 'vod');
          const card = document.createElement('a');
          card.href = `player.html?type=${itemType}&id=${item.id}`;
          card.className = 'stream-card';
          
          card.innerHTML = `
            <div class="card-img">
              <img src="${item.thumbnail || item.thumbnail_url || 'https://via.placeholder.com/400x225'}" 
                   alt="${item.title || item.name}" 
                   onerror="this.src='https://via.placeholder.com/400x225'">
              ${isLive ? '<div class="live-badge">LIVE</div>' : ''}
              ${item.requires_premium ? '<div class="premium-badge">PREMIUM</div>' : ''}
              <div class="card-content">
                <h3 class="card-title">${item.title || item.name}</h3>
                <div class="card-meta">
                  <span>${item.category || 'MMA'}</span>
                  <span class="card-views">${isLive ? `${item.viewers_count || 0} watching` : `${item.views_count || item.view_count || 0} views`}</span>
                </div>
              </div>
            </div>
          `;
          
          container.appendChild(card);
        });
        
      } catch (error) {
        console.error('Error loading MMA content:', error);
        const container = document.getElementById('mma-content');
        container.innerHTML = '<p class="error-message">Failed to load MMA content. Please try again later.</p>';
      }
    }
    
    // Load upcoming events
    async function loadUpcomingEvents() {
      try {
        const API_BASE = 'https://pegasus-backend.super-elmore95.workers.dev';
        const container = document.getElementById('upcoming-events-container');
        
        // Show loading state
        container.innerHTML = `
          <div class="loading-placeholder">
            <div class="loading-spinner"></div>
            <p>Loading upcoming events...</p>
          </div>
        `;
        
        const token = window.authManager ? window.authManager.getToken() : null;
        const headers = {
          'Content-Type': 'application/json'
        };
        
        if (token) {
          headers['Authorization'] = `Bearer ${token}`;
        }
        
        // In a real implementation, you would filter by date
        const response = await fetch(`${API_BASE}/api/content?type=live&is_upcoming=true`, { headers });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const content = await response.json();
        const upcomingEvents = content.live || [];
        
        // Clear loading state
        container.innerHTML = '';
        
        if (upcomingEvents.length === 0) {
          container.innerHTML = '<p class="no-content">No upcoming events found.</p>';
          return;
        }
        
        // Display events
        upcomingEvents.forEach(event => {
          const card = document.createElement('a');
          card.href = `player.html?type=live&id=${event.id}`;
          card.className = 'stream-card';
          
          const eventDate = new Date(event.start_time || event.created_at);
          const formattedDate = eventDate.toLocaleDateString('en-US', { 
            weekday: 'short', 
            month: 'short', 
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
          });
          
          card.innerHTML = `
            <div class="card-img">
              <img src="${event.thumbnail || event.thumbnail_url || 'https://via.placeholder.com/400x225'}" 
                   alt="${event.title}" 
                   onerror="this.src='https://via.placeholder.com/400x225'">
              <div class="live-badge">UPCOMING</div>
              ${event.requires_premium ? '<div class="premium-badge">PREMIUM</div>' : ''}
              <div class="card-content">
                <h3 class="card-title">${event.title}</h3>
                <div class="card-meta">
                  <span>${event.category || 'Sports'}</span>
                  <span class="card-views">${formattedDate}</span>
                </div>
              </div>
            </div>
          `;
          
          container.appendChild(card);
        });
        
      } catch (error) {
        console.error('Error loading upcoming events:', error);
        const container = document.getElementById('upcoming-events-container');
        container.innerHTML = '<p class="error-message">Failed to load upcoming events. Please try again later.</p>';
      }
    }

    // Load content by league
    async function loadContentByLeague(leagueName) {
      // This would filter content by league in a real implementation
      alert(`Loading content for ${leagueName}. This would filter content in a real implementation.`);
      
      // You would make an API call to filter content by league
      // For now, let's just reload the featured content
      loadFeaturedContent();
    }
  </script>
</body>
</html>
