<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PEGASUS Admin Panel</title>
  <style>
    :root {
      --admin-primary: #0a0a12;
      --admin-secondary: #141420;
      --admin-accent: #ff003c;
      --admin-accent-light: #ff2d5f;
      --admin-text: #ffffff;
      --admin-text-secondary: #b3b3b3;
      --admin-success: #00c853;
      --admin-warning: #ffab00;
      --admin-danger: #ff1744;
      --admin-card-bg: #1a1a2e;
      --admin-sidebar-width: 250px;
      --admin-header-height: 70px;
    }

    .admin-container {
      display: flex;
      min-height: 100vh;
      background-color: var(--admin-primary);
      color: var(--admin-text);
    }

    /* Sidebar Styles */
    .admin-sidebar {
      width: var(--admin-sidebar-width);
      background: var(--admin-secondary);
      height: 100vh;
      position: fixed;
      left: 0;
      top: 0;
      padding: 20px 0;
      overflow-y: auto;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .admin-sidebar-header {
      padding: 0 20px 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .admin-sidebar-header img {
      height: 30px;
    }

    .admin-sidebar-menu {
      list-style: none;
    }

    .admin-sidebar-menu li {
      margin-bottom: 5px;
    }

    .admin-sidebar-menu a {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      color: var(--admin-text);
      text-decoration: none;
      transition: all 0.3s ease;
      gap: 10px;
    }

    .admin-sidebar-menu a:hover,
    .admin-sidebar-menu a.active {
      background: var(--admin-accent);
      color: #000;
    }

    .admin-sidebar-menu a i {
      width: 20px;
      text-align: center;
    }

    /* Main Content Styles */
    .admin-main-content {
      flex: 1;
      margin-left: var(--admin-sidebar-width);
      padding: 20px;
    }

    .admin-header {
      background: var(--admin-secondary);
      padding: 15px 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .admin-header h1 {
      font-size: 24px;
    }

    .admin-user-menu {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .admin-user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--admin-accent);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    /* Dashboard Cards */
    .admin-dashboard-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .admin-card {
      background: var(--admin-card-bg);
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .admin-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .admin-card-title {
      font-size: 16px;
      color: var(--admin-text-secondary);
    }

    .admin-card-icon {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--admin-accent);
    }

    .admin-card-value {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .admin-card-growth {
      font-size: 14px;
      color: var(--admin-success);
      display: flex;
      align-items: center;
      gap: 5px;
    }

    /* Content Management */
    .admin-content-section {
      background: var(--admin-card-bg);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .admin-section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .admin-section-title {
      font-size: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .admin-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--admin-accent);
      color: #000;
      font-weight: 600;
      padding: 10px 20px;
      border-radius: 4px;
      text-decoration: none;
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .admin-btn:hover {
      background: var(--admin-accent-light);
      transform: translateY(-2px);
    }

    .admin-btn-outline {
      background: transparent;
      border: 2px solid var(--admin-accent);
      color: var(--admin-accent);
    }

    .admin-btn-outline:hover {
      background: var(--admin-accent);
      color: #000;
    }

    .admin-btn-sm {
      padding: 6px 12px;
      font-size: 14px;
    }

    /* Tables */
    .admin-table-responsive {
      overflow-x: auto;
    }

    .admin-table {
      width: 100%;
      border-collapse: collapse;
    }

    .admin-table th, 
    .admin-table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .admin-table th {
      background: rgba(255, 255, 255, 0.05);
      font-weight: 600;
    }

    .admin-table tr:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    .admin-status-badge {
      display: inline-block;
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }

    .admin-status-live {
      background: rgba(255, 23, 68, 0.2);
      color: var(--admin-danger);
    }

    .admin-status-draft {
      background: rgba(255, 171, 0, 0.2);
      color: var(--admin-warning);
    }

    .admin-status-published {
      background: rgba(0, 200, 83, 0.2);
      color: var(--admin-success);
    }

    .admin-action-buttons {
      display: flex;
      gap: 10px;
    }

    /* Forms */
    .admin-form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .admin-form-group {
      margin-bottom: 20px;
    }

    .admin-form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .admin-form-control {
      width: 100%;
      padding: 12px 15px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      color: var(--admin-text);
      font-size: 16px;
    }

    .admin-form-control:focus {
      outline: none;
      border-color: var(--admin-accent);
    }

    textarea.admin-form-control {
      min-height: 120px;
      resize: vertical;
    }

    .admin-form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 15px;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Preview Box */
    .admin-preview-box {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      padding: 20px;
      margin-top: 20px;
    }

    .admin-preview-title {
      font-size: 16px;
      margin-bottom: 15px;
      color: var(--admin-text-secondary);
    }

    .admin-thumbnail-preview {
      width: 100%;
      max-width: 300px;
      border-radius: 4px;
      overflow: hidden;
    }

    .admin-thumbnail-preview img {
      width: 100%;
      height: auto;
      display: block;
    }

    /* Tabs */
    .admin-tabs {
      display: flex;
      gap: 5px;
      margin-bottom: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .admin-tab {
      padding: 10px 20px;
      cursor: pointer;
      background: transparent;
      border: none;
      color: var(--admin-text-secondary);
      font-weight: 500;
      position: relative;
    }

    .admin-tab.active {
      color: var(--admin-accent);
    }

    .admin-tab.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 100%;
      height: 3px;
      background: var(--admin-accent);
    }

    .admin-tab-content {
      display: none;
    }

    .admin-tab-content.active {
      display: block;
    }

    /* Responsive */
    @media (max-width: 992px) {
      .admin-sidebar {
        transform: translateX(-100%);
      }
      
      .admin-sidebar.active {
        transform: translateX(0);
      }
      
      .admin-main-content {
        margin-left: 0;
      }
      
      .admin-menu-toggle {
        display: block;
      }
    }

    /* Toggle button for mobile */
    .admin-menu-toggle {
      display: none;
      background: var(--admin-accent);
      color: #000;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 4px;
      font-size: 20px;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .admin-dashboard-cards {
        grid-template-columns: 1fr;
      }
      
      .admin-form-grid {
        grid-template-columns: 1fr;
      }
      
      .admin-menu-toggle {
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .admin-sidebar {
        width: 100%;
      }
    }

    /* Content type forms */
    .content-type-form {
      display: none;
    }
    
    .content-type-form.active {
      display: block;
    }
  </style>
</head>
<body>
  <div class="admin-container">
    <!-- Sidebar -->
    <aside class="admin-sidebar">
      <div class="admin-sidebar-header">
        <img src="images/pegasus-logo.png" alt="PEGASUS Logo">
        <h2>PEGASUS Admin</h2>
      </div>
      
      <ul class="admin-sidebar-menu">
        <li><a href="#" class="active"><i class="fas fa-home"></i> Dashboard</a></li>
        <li><a href="#live-streams"><i class="fas fa-broadcast-tower"></i> Live Streams</a></li>
        <li><a href="#vod-content"><i class="fas fa-video"></i> VOD Content</a></li>
        <li><a href="#highlights"><i class="fas fa-star"></i> Highlights</a></li>
        <li><a href="#channels"><i class="fas fa-tv"></i> Channels</a></li>
        <li><a href="#banners"><i class="fas fa-images"></i> Banners & Hero</a></li>
        <li><a href="#users"><i class="fas fa-users"></i> Users</a></li>
        <li><a href="#subscriptions"><i class="fas fa-credit-card"></i> Subscriptions</a></li>
        <li><a href="#analytics"><i class="fas fa-chart-bar"></i> Analytics</a></li>
        <li><a href="#settings"><i class="fas fa-cog"></i> Settings</a></li>
        <li><a href="#" id="admin-logout"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
      </ul>
    </aside>

    <!-- Main Content -->
    <div class="admin-main-content">
      <!-- Header -->
      <div class="admin-header">
        <button class="admin-menu-toggle" id="adminMenuToggle">
          <i class="fas fa-bars"></i>
        </button>
        
        <h1>Admin Dashboard</h1>
        
        <div class="admin-user-menu">
          <div class="admin-notifications">
            <i class="fas fa-bell"></i>
          </div>
          <div class="admin-user-avatar">A</div>
        </div>
      </div>

      <!-- Dashboard Stats -->
      <div class="admin-dashboard-cards">
        <div class="admin-card">
          <div class="admin-card-header">
            <div class="admin-card-title">Live Streams</div>
            <div class="admin-card-icon">
              <i class="fas fa-broadcast-tower"></i>
            </div>
          </div>
          <div class="admin-card-value" id="live-streams-count">0</div>
          <div class="admin-card-growth">
            <i class="fas fa-arrow-up"></i> <span id="live-streams-growth">0</span> new today
          </div>
        </div>
        
        <div class="admin-card">
          <div class="admin-card-header">
            <div class="admin-card-title">VOD Content</div>
            <div class="admin-card-icon">
              <i class="fas fa-video"></i>
            </div>
          </div>
          <div class="admin-card-value" id="vod-count">0</div>
          <div class="admin-card-growth">
            <i class="fas fa-arrow-up"></i> <span id="vod-growth">0</span> new this week
          </div>
        </div>
        
        <div class="admin-card">
          <div class="admin-card-header">
            <div class="admin-card-title">Total Views</div>
            <div class="admin-card-icon">
              <i class="fas fa-eye"></i>
            </div>
          </div>
          <div class="admin-card-value" id="total-views">0</div>
          <div class="admin-card-growth">
            <i class="fas fa-arrow-up"></i> <span id="views-growth">0</span> from last week
          </div>
        </div>
        
        <div class="admin-card">
          <div class="admin-card-header">
            <div class="admin-card-title">Active Users</div>
            <div class="admin-card-icon">
              <i class="fas fa-users"></i>
            </div>
          </div>
          <div class="admin-card-value" id="active-users">0</div>
          <div class="admin-card-growth">
            <i class="fas fa-arrow-up"></i> <span id="online-users">0</span> currently online
          </div>
        </div>
      </div>

      <!-- Content Type Selection -->
      <div class="admin-content-section">
        <div class="admin-section-header">
          <h2 class="admin-section-title">
            <i class="fas fa-plus-circle"></i> Add New Content
          </h2>
        </div>

        <div class="admin-tabs">
          <button class="admin-tab active" data-content-type="live">Live Stream</button>
          <button class="admin-tab" data-content-type="vod">VOD</button>
          <button class="admin-tab" data-content-type="highlight">Highlight</button>
          <button class="admin-tab" data-content-type="channel">Channel</button>
          <button class="admin-tab" data-content-type="banner">Banner</button>
        </div>

        <!-- Live Stream Form -->
        <form id="live-form" class="content-type-form active">
          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="live-title">Title *</label>
              <input type="text" id="live-title" class="admin-form-control" required>
            </div>
            
            <div class="admin-form-group">
              <label for="live-category">Category *</label>
              <select id="live-category" class="admin-form-control" required>
                <option value="">Select Category</option>
                <!-- Categories will be populated dynamically -->
              </select>
            </div>
          </div>

          <div class="admin-form-group">
            <label for="live-description">Description</label>
            <textarea id="live-description" class="admin-form-control"></textarea>
          </div>

          <div class="admin-form-group">
            <label for="live-embed">Embed Code *</label>
            <textarea id="live-embed" class="admin-form-control" required></textarea>
          </div>

          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="live-thumbnail">Thumbnail URL</label>
              <input type="url" id="live-thumbnail" class="admin-form-control">
            </div>
            
            <div class="admin-form-group">
              <label for="live-premium">Premium Content</label>
              <select id="live-premium" class="admin-form-control">
                <option value="0">No</option>
                <option value="1">Yes</option>
              </select>
            </div>
          </div>

          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="live-is-live">Is Currently Live?</label>
              <select id="live-is-live" class="admin-form-control">
                <option value="0">No</option>
                <option value="1">Yes</option>
              </select>
            </div>
          </div>

          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="live-start">Start Time</label>
              <input type="datetime-local" id="live-start" class="admin-form-control">
            </div>
            
            <div class="admin-form-group">
              <label for="live-end">End Time</label>
              <input type="datetime-local" id="live-end" class="admin-form-control">
            </div>
          </div>

          <div class="admin-form-actions">
            <button type="button" class="admin-btn admin-btn-outline" onclick="hideAllForms()">Cancel</button>
            <button type="submit" class="admin-btn">Save Live Stream</button>
          </div>
        </form>

        <!-- VOD Form -->
        <form id="vod-form" class="content-type-form">
          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="vod-title">Title *</label>
              <input type="text" id="vod-title" class="admin-form-control" required>
            </div>
            
            <div class="admin-form-group">
              <label for="vod-category">Category *</label>
              <select id="vod-category" class="admin-form-control" required>
                <option value="">Select Category</option>
                <!-- Categories will be populated dynamically -->
              </select>
            </div>
          </div>

          <div class="admin-form-group">
            <label for="vod-description">Description</label>
            <textarea id="vod-description" class="admin-form-control"></textarea>
          </div>

          <div class="admin-form-group">
            <label for="vod-embed">Embed Code *</label>
            <textarea id="vod-embed" class="admin-form-control" required></textarea>
          </div>

          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="vod-thumbnail">Thumbnail URL</label>
              <input type="url" id="vod-thumbnail" class="admin-form-control">
            </div>
            
            <div class="admin-form-group">
              <label for="vod-duration">Duration (HH:MM:SS)</label>
              <input type="text" id="vod-duration" class="admin-form-control" placeholder="01:30:00">
            </div>
          </div>

          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="vod-premium">Premium Content</label>
              <select id="vod-premium" class="admin-form-control">
                <option value="0">No</option>
                <option value="1">Yes</option>
              </select>
            </div>
          </div>

          <div class="admin-form-actions">
            <button type="button" class="admin-btn admin-btn-outline" onclick="hideAllForms()">Cancel</button>
            <button type="submit" class="admin-btn">Save VOD</button>
          </div>
        </form>

        <!-- Highlight Form -->
        <form id="highlight-form" class="content-type-form">
          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="highlight-title">Title *</label>
              <input type="text" id="highlight-title" class="admin-form-control" required>
            </div>
            
            <div class="admin-form-group">
              <label for="highlight-category">Category *</label>
              <select id="highlight-category" class="admin-form-control" required>
                <option value="">Select Category</option>
                <!-- Categories will be populated dynamically -->
              </select>
            </div>
          </div>

          <div class="admin-form-group">
            <label for="highlight-description">Description</label>
            <textarea id="highlight-description" class="admin-form-control"></textarea>
          </div>

          <div class="admin-form-group">
            <label for="highlight-embed">Embed Code *</label>
            <textarea id="highlight-embed" class="admin-form-control" required></textarea>
          </div>

          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="highlight-thumbnail">Thumbnail URL</label>
              <input type="url" id="highlight-thumbnail" class="admin-form-control">
            </div>
            
            <div class="admin-form-group">
              <label for="highlight-duration">Duration (HH:MM:SS)</label>
              <input type="text" id="highlight-duration" class="admin-form-control" placeholder="00:10:00">
            </div>
          </div>

          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="highlight-premium">Premium Content</label>
              <select id="highlight-premium" class="admin-form-control">
                <option value="0">No</option>
                <option value="1">Yes</option>
              </select>
            </div>
          </div>

          <div class="admin-form-actions">
            <button type="button" class="admin-btn admin-btn-outline" onclick="hideAllForms()">Cancel</button>
            <button type="submit" class="admin-btn">Save Highlight</button>
          </div>
        </form>

        <!-- Channel Form -->
        <form id="channel-form" class="content-type-form">
          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="channel-name">Name *</label>
              <input type="text" id="channel-name" class="admin-form-control" required>
            </div>
            
            <div class="admin-form-group">
              <label for="channel-category">Category *</label>
              <select id="channel-category" class="admin-form-control" required>
                <option value="">Select Category</option>
                <!-- Categories will be populated dynamically -->
              </select>
            </div>
          </div>

          <div class="admin-form-group">
            <label for="channel-description">Description</label>
            <textarea id="channel-description" class="admin-form-control"></textarea>
          </div>

          <div class="admin-form-group">
            <label for="channel-embed">Embed Code *</label>
            <textarea id="channel-embed" class="admin-form-control" required></textarea>
          </div>

          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="channel-thumbnail">Thumbnail URL</label>
              <input type="url" id="channel-thumbnail" class="admin-form-control">
            </div>
            
            <div class="admin-form-group">
              <label for="channel-live">Is Live?</label>
              <select id="channel-live" class="admin-form-control">
                <option value="0">No</option>
                <option value="1">Yes</option>
              </select>
            </div>
          </div>

          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="channel-premium">Premium Content</label>
              <select id="channel-premium" class="admin-form-control">
                <option value="0">No</option>
                <option value="1">Yes</option>
              </select>
            </div>
            
            <div class="admin-form-group">
              <label for="channel-viewers">Viewers Count</label>
              <input type="number" id="channel-viewers" class="admin-form-control" value="0">
            </div>
          </div>

          <div class="admin-form-actions">
            <button type="button" class="admin-btn admin-btn-outline" onclick="hideAllForms()">Cancel</button>
            <button type="submit" class="admin-btn">Save Channel</button>
          </div>
        </form>

        <!-- Banner Form -->
        <form id="banner-form" class="content-type-form">
          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="banner-title">Title *</label>
              <input type="text" id="banner-title" class="admin-form-control" required>
            </div>
            
            <div class="admin-form-group">
              <label for="banner-image">Image URL *</label>
              <input type="url" id="banner-image" class="admin-form-control" required>
            </div>
          </div>

          <div class="admin-form-group">
            <label for="banner-description">Description</label>
            <textarea id="banner-description" class="admin-form-control"></textarea>
          </div>

          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="banner-target">Target URL</label>
              <input type="url" id="banner-target" class="admin-form-control">
            </div>
            
            <div class="admin-form-group">
              <label for="banner-active">Active</label>
              <select id="banner-active" class="admin-form-control">
                <option value="1">Yes</option>
                <option value="0">No</option>
              </select>
            </div>
          </div>

          <div class="admin-form-grid">
            <div class="admin-form-group">
              <label for="banner-start">Start Date</label>
              <input type="datetime-local" id="banner-start" class="admin-form-control">
            </div>
            
            <div class="admin-form-group">
              <label for="banner-end">End Date</label>
              <input type="datetime-local" id="banner-end" class="admin-form-control">
            </div>
          </div>

          <div class="admin-form-actions">
            <button type="button" class="admin-btn admin-btn-outline" onclick="hideAllForms()">Cancel</button>
            <button type="submit" class="admin-btn">Save Banner</button>
          </div>
        </form>
      </div>

      <!-- Live Streams Management -->
      <div class="admin-content-section" id="live-streams-section">
        <div class="admin-section-header">
          <h2 class="admin-section-title">
            <i class="fas fa-broadcast-tower"></i> Live Streams
          </h2>
          <button class="admin-btn" onclick="showForm('live')">
            <i class="fas fa-plus"></i> Add New Stream
          </button>
        </div>

        <div class="admin-table-responsive">
          <table class="admin-table">
            <thead>
              <tr>
                <th>Title</th>
                <th>Category</th>
                <th>Status</th>
                <th>Viewers</th>
                <th>Start Time</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="live-streams-table-body">
              <!-- Content will be populated by JavaScript -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- VOD Content Management -->
      <div class="admin-content-section" id="vod-section">
        <div class="admin-section-header">
          <h2 class="admin-section-title">
            <i class="fas fa-video"></i> VOD Content
          </h2>
          <button class="admin-btn" onclick="showForm('vod')">
            <i class="fas fa-plus"></i> Add VOD
          </button>
        </div>

        <div class="admin-table-responsive">
          <table class="admin-table">
            <thead>
              <tr>
                <th>Title</th>
                <th>Category</th>
                <th>Views</th>
                <th>Duration</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="vod-table-body">
              <!-- Content will be populated by JavaScript -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Highlights Management -->
      <div class="admin-content-section" id="highlights-section">
        <div class="admin-section-header">
          <h2 class="admin-section-title">
            <i class="fas fa-star"></i> Highlights
          </h2>
          <button class="admin-btn" onclick="showForm('highlight')">
            <i class="fas fa-plus"></i> Add Highlight
          </button>
        </div>

        <div class="admin-table-responsive">
          <table class="admin-table">
            <thead>
              <tr>
                <th>Title</th>
                <th>Category</th>
                <th>Views</th>
                <th>Duration</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="highlights-table-body">
              <!-- Content will be populated by JavaScript -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Channels Management -->
      <div class="admin-content-section" id="channels-section">
        <div class="admin-section-header">
          <h2 class="admin-section-title">
            <i class="fas fa-tv"></i> Channels
          </h2>
          <button class="admin-btn" onclick="showForm('channel')">
            <i class="fas fa-plus"></i> Add Channel
          </button>
        </div>

        <div class="admin-table-responsive">
          <table class="admin-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Category</th>
                <th>Status</th>
                <th>Viewers</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="channels-table-body">
              <!-- Content will be populated by JavaScript -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Hero Banners Management -->
      <div class="admin-content-section" id="banners-section">
        <div class="admin-section-header">
          <h2 class="admin-section-title">
            <i class="fas fa-images"></i> Hero Banners
          </h2>
          <button class="admin-btn" onclick="showForm('banner')">
            <i class="fas fa-plus"></i> Add Banner
          </button>
        </div>

        <div class="admin-table-responsive">
          <table class="admin-table">
            <thead>
              <tr>
                <th>Title</th>
                <th>Status</th>
                <th>Start Date</th>
                <th>End Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="banners-table-body">
              <!-- Content will be populated by JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    // API base URL
    const API_BASE = 'https://pegasus-backend.super-elmore95.workers.dev';
    
    // Global state
    let currentContent = {
      live: [],
      vod: [],
      highlights: [],
      banners: [],
      channels: [],
      users: [],
      subscriptions: []
    };

    // Available categories (will be populated from backend)
    let availableCategories = [];

    // Check if user is authenticated
    function isAuthenticated() {
      const user = localStorage.getItem('pegasus_user');
      const token = localStorage.getItem('pegasus_token');
      return !!(user && token);
    }

    // Get current user
    function getCurrentUser() {
      const userStr = localStorage.getItem('pegasus_user');
      return userStr ? JSON.parse(userStr) : null;
    }

    // Get token
    function getToken() {
      return localStorage.getItem('pegasus_token');
    }

    document.addEventListener('DOMContentLoaded', async function() {
      // Check if user is authenticated
      if (!isAuthenticated()) {
        alert('Please sign in to access admin panel');
        window.location.href = 'signin.html?redirect=admin.html';
        return;
      }
      
      // Verify the user is an admin
      try {
        const token = getToken();
        const user = getCurrentUser();
        
        // Check if user is admin
        if (user && user.role === 'admin') {
          // Initialize the admin panel
          initAdminPanel();
          
          // Load initial data
          await loadDashboardData();
          await loadCategories(); // Load categories first
          await loadContentData();
        } else {
          alert('Admin access required');
          window.location.href = 'index.html';
        }
      } catch (error) {
        console.error('Error verifying admin access:', error);
        alert('Error verifying admin access');
        window.location.href = 'index.html';
      }
    });

    function initAdminPanel() {
      // Mobile menu toggle
      const menuToggle = document.getElementById('adminMenuToggle');
      const sidebar = document.querySelector('.admin-sidebar');
      
      if (menuToggle && sidebar) {
        menuToggle.addEventListener('click', function() {
          sidebar.classList.toggle('active');
        });
      }
      
      // Content type tabs
      const contentTabs = document.querySelectorAll('.admin-tab[data-content-type]');
      
      contentTabs.forEach(tab => {
        tab.addEventListener('click', function() {
          const contentType = this.getAttribute('data-content-type');
          
          // Deactivate all tabs
          contentTabs.forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.content-type-form').forEach(f => f.classList.remove('active'));
          
          // Activate current tab
          this.classList.add('active');
          document.getElementById(`${contentType}-form`).classList.add('active');
        });
      });
      
      // Form submissions
      document.getElementById('live-form').addEventListener('submit', function(e) {
        e.preventDefault();
        handleFormSubmit('live');
      });
      
      document.getElementById('vod-form').addEventListener('submit', function(e) {
        e.preventDefault();
        handleFormSubmit('vod');
      });
      
      document.getElementById('highlight-form').addEventListener('submit', function(e) {
        e.preventDefault();
        handleFormSubmit('highlight');
      });
      
      document.getElementById('channel-form').addEventListener('submit', function(e) {
        e.preventDefault();
        handleFormSubmit('channel');
      });
      
      document.getElementById('banner-form').addEventListener('submit', function(e) {
        e.preventDefault();
        handleFormSubmit('banner');
      });
      
      // Logout functionality
      const adminLogout = document.getElementById('admin-logout');
      if (adminLogout) {
        adminLogout.addEventListener('click', function(e) {
          e.preventDefault();
          if (confirm('Are you sure you want to logout?')) {
            localStorage.removeItem('pegasus_user');
            localStorage.removeItem('pegasus_token');
            window.location.href = 'index.html';
          }
        });
      }
    }

    // Load categories from backend
    async function loadCategories() {
      try {
        const token = getToken();
        const response = await fetch(`${API_BASE}/api/content`, {
          headers: {
            'Authorization': `Bearer ${token}`
          }
        });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const content = await response.json();
        
        // Extract unique categories from all content types
        const categories = new Set();
        
        // Extract from live streams
        if (content.live) {
          content.live.forEach(item => {
            if (item.category) categories.add(item.category);
          });
        }
        
        // Extract from VOD
        if (content.vod) {
          content.vod.forEach(item => {
            if (item.category) categories.add(item.category);
          });
        }
        
        // Extract from highlights
        if (content.highlights) {
          content.highlights.forEach(item => {
            if (item.category) categories.add(item.category);
          });
        }
        
        // Extract from channels
        if (content.channels) {
          content.channels.forEach(item => {
            if (item.category) categories.add(item.category);
          });
        }
        
        // Convert Set to Array and sort
        availableCategories = Array.from(categories).sort();
        
        // Populate category dropdowns in all forms
        populateCategoryDropdowns();
      } catch (error) {
        console.error('Error loading categories:', error);
      }
    }

    // Populate category dropdowns in all forms
    function populateCategoryDropdowns() {
      const categoryDropdowns = document.querySelectorAll('select[id$="-category"]');
      
      categoryDropdowns.forEach(dropdown => {
        // Clear existing options except the first one
        while (dropdown.options.length > 1) {
          dropdown.remove(1);
        }
        
        // Add categories from availableCategories
        availableCategories.forEach(category => {
          const option = document.createElement('option');
          option.value = category;
          option.textContent = category;
          dropdown.appendChild(option);
        });
      });
    }

    async function loadDashboardData() {
      try {
        const token = getToken();
        const response = await fetch(`${API_BASE}/api/admin/stats`, {
          headers: {
            'Authorization': `Bearer ${token}`
          }
        });
        
        if (!response.ok) {
          if (response.status === 401 || response.status === 403) {
            alert('Admin access required');
            window.location.href = 'index.html';
            return;
          }
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        // Update dashboard cards
        document.getElementById('live-streams-count').textContent = data.content?.live || 0;
        document.getElementById('vod-count').textContent = data.content?.vod || 0;
        document.getElementById('total-views').textContent = data.revenue ? formatNumber(data.revenue) : 0;
        document.getElementById('active-users').textContent = data.users ? formatNumber(data.users) : 0;
        document.getElementById('online-users').textContent = data.active_subscriptions || 0;
      } catch (error) {
        console.error('Error loading dashboard data:', error);
      }
    }

    async function loadContentData() {
      try {
        const token = getToken();
        const response = await fetch(`${API_BASE}/api/content`, {
          headers: {
            'Authorization': `Bearer ${token}`
          }
        });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const content = await response.json();
        
        // Store content globally
        currentContent = content;
        
        // Update all tables
        updateLiveStreamsTable(content.live || []);
        updateVodTable(content.vod || []);
        updateHighlightsTable(content.highlights || []);
        updateChannelsTable(content.channels || []);
        updateBannersTable(content.banners || []);
      } catch (error) {
        console.error('Error loading content data:', error);
      }
    }

    function updateLiveStreamsTable(streams) {
      const tableBody = document.getElementById('live-streams-table-body');
      if (!tableBody) return;
      
      tableBody.innerHTML = '';
      
      if (streams.length === 0) {
        tableBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">No live streams found</td></tr>';
        return;
      }
      
      streams.forEach(stream => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${stream.title}</td>
          <td>${stream.category || 'N/A'}</td>
          <td><span class="admin-status-badge admin-status-${stream.is_live ? 'live' : 'draft'}">${stream.is_live ? 'LIVE' : 'DRAFT'}</span></td>
          <td>${stream.viewers_count ? formatNumber(stream.viewers_count) : 0}</td>
          <td>${stream.start_time ? formatDate(stream.start_time) : 'N/A'}</td>
          <td class="admin-action-buttons">
            <button class="admin-btn admin-btn-outline admin-btn-sm" onclick="editContent(${stream.id}, 'live')"><i class="fas fa-edit"></i></button>
            <button class="admin-btn admin-btn-outline admin-btn-sm" onclick="deleteContent(${stream.id}, 'live')"><i class="fas fa-trash"></i></button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }

    function updateVodTable(vods) {
      const tableBody = document.getElementById('vod-table-body');
      if (!tableBody) return;
      
      tableBody.innerHTML = '';
      
      if (vods.length === 0) {
        tableBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">No VOD content found</td></tr>';
        return;
      }
      
      vods.forEach(vod => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${vod.title}</td>
          <td>${vod.category || 'N/A'}</td>
          <td>${vod.views_count ? formatNumber(vod.views_count) : 0}</td>
          <td>${vod.duration || 'N/A'}</td>
          <td><span class="admin-status-badge admin-status-published">PUBLISHED</span></td>
          <td class="admin-action-buttons">
            <button class="admin-btn admin-btn-outline admin-btn-sm" onclick="editContent(${vod.id}, 'vod')"><i class="fas fa-edit"></i></button>
            <button class="admin-btn admin-btn-outline admin-btn-sm" onclick="deleteContent(${vod.id}, 'vod')"><i class="fas fa-trash"></i></button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }

    function updateHighlightsTable(highlights) {
      const tableBody = document.getElementById('highlights-table-body');
      if (!tableBody) return;
      
      tableBody.innerHTML = '';
      
      if (highlights.length === 0) {
        tableBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">No highlights found</td></tr>';
        return;
      }
      
      highlights.forEach(highlight => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${highlight.title}</td>
          <td>${highlight.category || 'N/A'}</td>
          <td>${highlight.view_count ? formatNumber(highlight.view_count) : 0}</td>
          <td>${highlight.duration || 'N/A'}</td>
          <td><span class="admin-status-badge admin-status-published">PUBLISHED</span></td>
          <td class="admin-action-buttons">
            <button class="admin-btn admin-btn-outline admin-btn-sm" onclick="editContent(${highlight.id}, 'highlight')"><i class="fas fa-edit"></i></button>
            <button class="admin-btn admin-btn-outline admin-btn-sm" onclick="deleteContent(${highlight.id}, 'highlight')"><i class="fas fa-trash"></i></button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }

    function updateChannelsTable(channels) {
      const tableBody = document.getElementById('channels-table-body');
      if (!tableBody) return;
      
      tableBody.innerHTML = '';
      
      if (channels.length === 0) {
        tableBody.innerHTML = '<tr><td colspan="5" style="text-align: center;">No channels found</td></tr>';
        return;
      }
      
      channels.forEach(channel => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${channel.name}</td>
          <td>${channel.category || 'N/A'}</td>
          <td><span class="admin-status-badge admin-status-${channel.is_live ? 'live' : 'draft'}">${channel.is_live ? 'LIVE' : 'OFFLINE'}</span></td>
          <td>${channel.viewers_count || 0}</td>
          <td class="admin-action-buttons">
            <button class="admin-btn admin-btn-outline admin-btn-sm" onclick="editContent(${channel.id}, 'channel')"><i class="fas fa-edit"></i></button>
            <button class="admin-btn admin-btn-outline admin-btn-sm" onclick="deleteContent(${channel.id}, 'channel')"><i class="fas fa-trash"></i></button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }

    function updateBannersTable(banners) {
      const tableBody = document.getElementById('banners-table-body');
      if (!tableBody) return;
      
      tableBody.innerHTML = '';
      
      if (banners.length === 0) {
        tableBody.innerHTML = '<tr><td colspan="5" style="text-align: center;">No banners found</td></tr>';
        return;
      }
      
      banners.forEach(banner => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${banner.title}</td>
          <td><span class="admin-status-badge admin-status-${banner.is_active ? 'published' : 'draft'}">${banner.is_active ? 'ACTIVE' : 'INACTIVE'}</span></td>
          <td>${banner.start_date ? formatDate(banner.start_date) : 'N/A'}</td>
          <td>${banner.end_date ? formatDate(banner.end_date) : 'N/A'}</td>
          <td class="admin-action-buttons">
            <button class="admin-btn admin-btn-outline admin-btn-sm" onclick="editContent(${banner.id}, 'banner')"><i class="fas fa-edit"></i></button>
            <button class="admin-btn admin-btn-outline admin-btn-sm" onclick="deleteContent(${banner.id}, 'banner')"><i class="fas fa-trash"></i></button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }

    function showForm(contentType) {
      // Hide all forms first
      hideAllForms();
      
      // Show the selected form
      document.getElementById(`${contentType}-form`).style.display = 'block';
      
      // Scroll to form
      document.getElementById(`${contentType}-form`).scrollIntoView({ behavior: 'smooth' });
      
      // Activate the corresponding tab
      document.querySelectorAll('.admin-tab').forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-content-type') === contentType) {
          tab.classList.add('active');
        }
      });
    }

    function hideAllForms() {
      document.querySelectorAll('.content-type-form').forEach(form => {
        form.style.display = 'none';
        form.reset();
        
        // Clear edit mode
        form.removeAttribute('data-edit-mode');
        form.removeAttribute('data-edit-id');
        
        // Reset submit button text
        const submitBtn = form.querySelector('button[type="submit"]');
        const contentType = form.id.split('-')[0];
        submitBtn.textContent = `Save ${contentType.charAt(0).toUpperCase() + contentType.slice(1)}`;
      });
    }

    async function handleFormSubmit(contentType) {
      try {
        const token = getToken();
        const form = document.getElementById(`${contentType}-form`);
        const isEditMode = form.getAttribute('data-edit-mode') === 'true';
        const editId = form.getAttribute('data-edit-id');
        
        // Get form data based on content type
        let formData = {};
        
        switch (contentType) {
          case 'live':
            formData = {
              title: document.getElementById('live-title').value,
              description: document.getElementById('live-description').value,
              embed_code: document.getElementById('live-embed').value,
              category: document.getElementById('live-category').value,
              is_live: parseInt(document.getElementById('live-is-live').value),
              start_time: document.getElementById('live-start').value,
              end_time: document.getElementById('live-end').value,
              thumbnail: document.getElementById('live-thumbnail').value,
              requires_premium: parseInt(document.getElementById('live-premium').value)
            };
            break;
            
          case 'vod':
            formData = {
              title: document.getElementById('vod-title').value,
              description: document.getElementById('vod-description').value,
              embed_code: document.getElementById('vod-embed').value,
              category: document.getElementById('vod-category').value,
              thumbnail: document.getElementById('vod-thumbnail').value,
              duration: document.getElementById('vod-duration').value,
              requires_premium: parseInt(document.getElementById('vod-premium').value)
            };
            break;
            
          case 'highlight':
            formData = {
              title: document.getElementById('highlight-title').value,
              description: document.getElementById('highlight-description').value,
              embed_code: document.getElementById('highlight-embed').value,
              category: document.getElementById('highlight-category').value,
              thumbnail: document.getElementById('highlight-thumbnail').value,
              duration: document.getElementById('highlight-duration').value,
              requires_premium: parseInt(document.getElementById('highlight-premium').value)
            };
            break;
            
          case 'channel':
            formData = {
              name: document.getElementById('channel-name').value,
              description: document.getElementById('channel-description').value,
              embed_code: document.getElementById('channel-embed').value,
              category: document.getElementById('channel-category').value,
              thumbnail_url: document.getElementById('channel-thumbnail').value,
              is_live: parseInt(document.getElementById('channel-live').value),
              requires_premium: parseInt(document.getElementById('channel-premium').value),
              viewers_count: parseInt(document.getElementById('channel-viewers').value) || 0
            };
            break;
            
          case 'banner':
            formData = {
              title: document.getElementById('banner-title').value,
              description: document.getElementById('banner-description').value,
              image_url: document.getElementById('banner-image').value,
              target_url: document.getElementById('banner-target').value,
              is_active: parseInt(document.getElementById('banner-active').value),
              start_date: document.getElementById('banner-start').value,
              end_date: document.getElementById('banner-end').value
            };
            break;
        }
        
        // Remove empty fields
        Object.keys(formData).forEach(key => {
          if (formData[key] === '' || formData[key] === undefined) {
            delete formData[key];
          }
        });
        
        let url, method;
        if (isEditMode) {
          // Update existing content
          url = `${API_BASE}/api/admin/content/${contentType}/${editId}`;
          method = 'PUT';
        } else {
          // Create new content
          url = `${API_BASE}/api/admin/content`;
          method = 'POST';
        }
        
        const response = await fetch(url, {
          method: method,
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify(isEditMode ? { data: formData } : { type: contentType, data: formData }),
        });
        
        if (response.ok) {
          alert(`${contentType.charAt(0).toUpperCase() + contentType.slice(1)} ${isEditMode ? 'updated' : 'added'} successfully!`);
          hideAllForms();
          loadContentData();
        } else {
          const errorText = await response.text();
          alert(`Error ${isEditMode ? 'updating' : 'adding'} ${contentType}: ${errorText}`);
        }
      } catch (error) {
        console.error('Error:', error);
        alert(`Error ${isEditMode ? 'updating' : 'adding'} ${contentType}: ${error.message}`);
      }
    }

    async function editContent(id, contentType) {
      try {
        const token = getToken();
        const response = await fetch(`${API_BASE}/api/content/${contentType}/${id}`, {
          headers: {
            'Authorization': `Bearer ${token}`
          }
        });
        
        if (!response.ok) throw new Error('Failed to fetch content');
        
        const content = await response.json();
        
        // Show the form for this content type
        showForm(contentType);
        
        // Populate form fields based on content type
        switch (contentType) {
          case 'live':
            document.getElementById('live-title').value = content.title || '';
            document.getElementById('live-description').value = content.description || '';
            document.getElementById('live-embed').value = content.embed_code || '';
            document.getElementById('live-category').value = content.category || '';
            document.getElementById('live-thumbnail').value = content.thumbnail || '';
            document.getElementById('live-premium').value = content.requires_premium || '0';
            document.getElementById('live-is-live').value = content.is_live ? '1' : '0';
            document.getElementById('live-start').value = content.start_time || '';
            document.getElementById('live-end').value = content.end_time || '';
            break;
            
          case 'vod':
            document.getElementById('vod-title').value = content.title || '';
            document.getElementById('vod-description').value = content.description || '';
            document.getElementById('vod-embed').value = content.embed_code || '';
            document.getElementById('vod-category').value = content.category || '';
            document.getElementById('vod-thumbnail').value = content.thumbnail || '';
            document.getElementById('vod-duration').value = content.duration || '';
            document.getElementById('vod-premium').value = content.requires_premium || '0';
            break;
            
          case 'highlight':
            document.getElementById('highlight-title').value = content.title || '';
            document.getElementById('highlight-description').value = content.description || '';
            document.getElementById('highlight-embed').value = content.embed_code || '';
            document.getElementById('highlight-category').value = content.category || '';
            document.getElementById('highlight-thumbnail').value = content.thumbnail || '';
            document.getElementById('highlight-duration').value = content.duration || '';
            document.getElementById('highlight-premium').value = content.requires_premium || '0';
            break;
            
          case 'channel':
            document.getElementById('channel-name').value = content.name || '';
            document.getElementById('channel-description').value = content.description || '';
            document.getElementById('channel-embed').value = content.embed_code || '';
            document.getElementById('channel-category').value = content.category || '';
            document.getElementById('channel-thumbnail').value = content.thumbnail_url || '';
            document.getElementById('channel-live').value = content.is_live ? '1' : '0';
            document.getElementById('channel-premium').value = content.requires_premium || '0';
            document.getElementById('channel-viewers').value = content.viewers_count || 0;
            break;
            
          case 'banner':
            document.getElementById('banner-title').value = content.title || '';
            document.getElementById('banner-description').value = content.description || '';
            document.getElementById('banner-image').value = content.image_url || '';
            document.getElementById('banner-target').value = content.target_url || '';
            document.getElementById('banner-active').value = content.is_active ? '1' : '0';
            document.getElementById('banner-start').value = content.start_date || '';
            document.getElementById('banner-end').value = content.end_date || '';
            break;
        }
        
        // Change form to edit mode
        const form = document.getElementById(`${contentType}-form`);
        form.setAttribute('data-edit-mode', 'true');
        form.setAttribute('data-edit-id', id);
        
        // Change submit button text
        form.querySelector('button[type="submit"]').textContent = `Update ${contentType.charAt(0).toUpperCase() + contentType.slice(1)}`;
      } catch (error) {
        console.error('Error fetching content for edit:', error);
        alert('Error loading content for editing');
      }
    }

    async function deleteContent(id, contentType) {
      if (confirm(`Are you sure you want to delete this ${contentType}?`)) {
        try {
          const token = getToken();
          const response = await fetch(`${API_BASE}/api/admin/content/${contentType}/${id}`, {
            method: 'DELETE',
            headers: {
              'Authorization': `Bearer ${token}`
            }
          });
          
          if (response.ok) {
            alert(`${contentType.charAt(0).toUpperCase() + contentType.slice(1)} deleted successfully!`);
            loadContentData();
          } else {
            alert(`Error deleting ${contentType}`);
          }
        } catch (error) {
          console.error('Error:', error);
          alert(`Error deleting ${contentType}`);
        }
      }
    }

    function formatNumber(num) {
      if (num >= 1000000) {
        return (num / 1000000).toFixed(1) + 'M';
      } else if (num >= 1000) {
        return (num / 1000).toFixed(1) + 'K';
      }
      return num;
    }

    function formatDate(dateString) {
      if (!dateString) return 'N/A';
      
      const options = { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' };
      return new Date(dateString).toLocaleDateString(undefined, options);
    }

    // Make functions available globally
    window.showForm = showForm;
    window.hideAllForms = hideAllForms;
    window.editContent = editContent;
    window.deleteContent = deleteContent;
  </script>
</body>
</html>
