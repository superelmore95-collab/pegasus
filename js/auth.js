const _0xd6163d=_0x36da;function _0x4b3a(){const _0x1f7add=['3812418HMTvAV','Network\x20error:\x20','scroll','href','699430IymvcQ','content-type','DELETE','logout-btn','538020eTARlP','/api/favorites/check?contentId=','getItem','pegasus_token','setupScrollHeader','admin','addComment','/api/comments?contentId=','preventDefault','Not\x20authenticated','/api/auth/signin','584CUwgka','Bearer\x20','Failed\x20to\x20initialize\x20AuthManager:','scrollY','isAuthenticated','location','PEGASUS_CONFIG\x20not\x20found,\x20using\x20defaults','favoriteId','Failed\x20to\x20add\x20comment','updateDesktopAuthUI','remove','signOut','get','Server\x20error:\x20','role','signIn','text','warn','toISOString','8ppoBpT','614418qsWnKz','favorites','status','405246QCMwlU','querySelector','POST','removeItem','setDate','Authentication\x20failed','message','updateMobileAuthUI','PEGASUS_CONFIG','scrolled','name','1.0.0','/api/auth/signup','.mobile-auth','getDate','getToken','split','checkRedirect','61558QHPQpM','signup.html','contains','addToFavorites','signUp','profile.html','https://pegasus-backend.super-elmore95.workers.dev','getElementById','/api/user/profile','error','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-chevron-down\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-dropdown\x22\x20id=\x22user-dropdown\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html\x22><i\x20class=\x22fas\x20fa-user\x22></i>\x20Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22favorites.html\x22><i\x20class=\x22fas\x20fa-heart\x22></i>\x20Favorites</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','stringify','API_BASE','getComments','3425190iQbwIC','setItem','Failed\x20to\x20add\x20to\x20favorites','target','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','show','/api/favorites','addEventListener','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-menu-mobile\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22profile.html\x22\x20class=\x22btn\x20btn-outline\x22><i\x20class=\x22fas\x20fa-user\x22></i>\x20Profile</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22favorites.html\x22\x20class=\x22btn\x20btn-outline\x22><i\x20class=\x22fas\x20fa-heart\x22></i>\x20Favorites</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','init','Registration\x20failed','classList','Failed\x20to\x20remove\x20from\x20favorites','updateAuthUI','Auth\x20check\x20failed:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-outline\x22\x20id=\x22mobile-logout-btn\x22><i\x20class=\x22fas\x20fa-sign-out-alt\x22></i>\x20Logout</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20','charAt','toUpperCase','30GkQZme','checkFavoriteStatus','pegasus_user','getCurrentUser','<a\x20href=\x22admin.html\x22><i\x20class=\x22fas\x20fa-cog\x22></i>\x20Admin</a>','<a\x20href=\x22admin.html\x22\x20class=\x22btn\x20btn-outline\x22><i\x20class=\x22fas\x20fa-cog\x22></i>\x20Admin</a>','pop','headers','signin.html','includes','token','header','click','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22signin.html\x22\x20class=\x22btn\x20btn-outline\x22>Sign\x20In</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22signup.html\x22\x20class=\x22btn\x20subscribe-btn\x22>Subscribe</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','&contentType=','parse','json','innerHTML','toggle','application/json','statusText'];_0x4b3a=function(){return _0x1f7add;};return _0x4b3a();}function _0x36da(_0x4e7bcc,_0x5da14f){const _0x4b3acc=_0x4b3a();return _0x36da=function(_0x36daac,_0x78dddb){_0x36daac=_0x36daac-0x1c8;let _0x1e28fb=_0x4b3acc[_0x36daac];return _0x1e28fb;},_0x36da(_0x4e7bcc,_0x5da14f);}(function(_0x8d81cc,_0x4d712d){const _0x448d5a=_0x36da,_0x40c941=_0x8d81cc();while(!![]){try{const _0x56249e=parseInt(_0x448d5a(0x1d3))/0x1+parseInt(_0x448d5a(0x21e))/0x2+-parseInt(_0x448d5a(0x222))/0x3*(parseInt(_0x448d5a(0x1cf))/0x4)+parseInt(_0x448d5a(0x1f3))/0x5+-parseInt(_0x448d5a(0x1d0))/0x6+parseInt(_0x448d5a(0x1e5))/0x7*(parseInt(_0x448d5a(0x22d))/0x8)+parseInt(_0x448d5a(0x21a))/0x9*(-parseInt(_0x448d5a(0x205))/0xa);if(_0x56249e===_0x4d712d)break;else _0x40c941['push'](_0x40c941['shift']());}catch(_0x2ec851){_0x40c941['push'](_0x40c941['shift']());}}}(_0x4b3a,0x55778));class AuthManager{constructor(){const _0x43f97c=_0x36da;this['API_BASE']=window[_0x43f97c(0x1db)]?window[_0x43f97c(0x1db)]['API_BASE']:_0x43f97c(0x1eb),this[_0x43f97c(0x1fc)]();}['init'](){const _0x1b910d=_0x36da;this[_0x1b910d(0x200)](),this[_0x1b910d(0x226)](),this[_0x1b910d(0x1e4)]();}[_0xd6163d(0x226)](){const _0x566df7=_0xd6163d,_0x497908=document[_0x566df7(0x1d4)](_0x566df7(0x210));if(!_0x497908)return;window[_0x566df7(0x1fa)](_0x566df7(0x21c),()=>{const _0x2c5cb1=_0x566df7;window[_0x2c5cb1(0x230)]>0x32?_0x497908[_0x2c5cb1(0x1fe)]['add'](_0x2c5cb1(0x1dc)):_0x497908[_0x2c5cb1(0x1fe)][_0x2c5cb1(0x237)](_0x2c5cb1(0x1dc));});}['checkRedirect'](){const _0x5d7f0a=_0xd6163d;if(this[_0x5d7f0a(0x231)]()){const _0x314606=window[_0x5d7f0a(0x232)]['pathname'][_0x5d7f0a(0x1e3)]('/')[_0x5d7f0a(0x20b)](),_0x20ef90=_0x314606===_0x5d7f0a(0x20d)||_0x314606===_0x5d7f0a(0x1e6);_0x20ef90&&setTimeout(()=>{const _0x3f8870=_0x5d7f0a;window[_0x3f8870(0x232)][_0x3f8870(0x21d)]=_0x3f8870(0x1ea);},0x64);}}async[_0xd6163d(0x1cb)](_0x53834f,_0x32c828,_0x2f5ef9){const _0x258694=_0xd6163d;try{const _0x297bec=await fetch(this[_0x258694(0x1f1)]+_0x258694(0x22c),{'method':_0x258694(0x1d5),'headers':{'Content-Type':'application/json'},'body':JSON[_0x258694(0x1f0)]({'email':_0x53834f,'password':_0x32c828})}),_0x522865=_0x297bec['headers']['get'](_0x258694(0x21f));if(!_0x522865||!_0x522865[_0x258694(0x20e)](_0x258694(0x218))){const _0x3a2950=await _0x297bec[_0x258694(0x1cc)]();return{'success':![],'error':_0x3a2950||_0x258694(0x1c9)+_0x297bec['status']+'\x20'+_0x297bec['statusText']};}const _0x58b1a1=await _0x297bec[_0x258694(0x215)]();if(_0x297bec['ok']){localStorage['setItem']('pegasus_user',JSON[_0x258694(0x1f0)](_0x58b1a1['user'])),localStorage[_0x258694(0x1f4)](_0x258694(0x225),_0x58b1a1[_0x258694(0x20f)]);if(_0x2f5ef9){const _0x265d54=new Date();_0x265d54[_0x258694(0x1d7)](_0x265d54[_0x258694(0x1e1)]()+0x1e),localStorage[_0x258694(0x1f4)]('pegasus_expiration',_0x265d54[_0x258694(0x1ce)]());}return this[_0x258694(0x200)](),{'success':!![],'data':_0x58b1a1};}else return{'success':![],'error':_0x58b1a1['error']||_0x258694(0x1d8)};}catch(_0x4e9266){return{'success':![],'error':_0x258694(0x21b)+_0x4e9266[_0x258694(0x1d9)]};}}async[_0xd6163d(0x1e9)](_0x239386,_0x4454b0,_0x290845){const _0x299391=_0xd6163d;try{const _0x96d91a=await fetch(this['API_BASE']+_0x299391(0x1df),{'method':_0x299391(0x1d5),'headers':{'Content-Type':_0x299391(0x218)},'body':JSON['stringify']({'name':_0x239386,'email':_0x4454b0,'password':_0x290845})}),_0x4b2150=_0x96d91a[_0x299391(0x20c)][_0x299391(0x1c8)](_0x299391(0x21f));if(!_0x4b2150||!_0x4b2150[_0x299391(0x20e)]('application/json')){const _0x9b9c36=await _0x96d91a[_0x299391(0x1cc)]();return{'success':![],'error':_0x9b9c36||_0x299391(0x1c9)+_0x96d91a[_0x299391(0x1d2)]+'\x20'+_0x96d91a[_0x299391(0x219)]};}const _0x4c1ea9=await _0x96d91a[_0x299391(0x215)]();return _0x96d91a['ok']?(localStorage[_0x299391(0x1f4)](_0x299391(0x207),JSON[_0x299391(0x1f0)](_0x4c1ea9['user'])),localStorage[_0x299391(0x1f4)]('pegasus_token',_0x4c1ea9[_0x299391(0x20f)]),this[_0x299391(0x200)](),{'success':!![],'data':_0x4c1ea9}):{'success':![],'error':_0x4c1ea9[_0x299391(0x1ee)]||_0x299391(0x1fd)};}catch(_0x2f24d8){return{'success':![],'error':_0x299391(0x21b)+_0x2f24d8[_0x299391(0x1d9)]};}}[_0xd6163d(0x231)](){const _0x162fad=_0xd6163d,_0x590894=localStorage[_0x162fad(0x224)](_0x162fad(0x207)),_0xf9bc30=localStorage[_0x162fad(0x224)]('pegasus_token');return!!(_0x590894&&_0xf9bc30);}[_0xd6163d(0x208)](){const _0x18dfb5=_0xd6163d,_0x32178b=localStorage['getItem'](_0x18dfb5(0x207));return _0x32178b?JSON[_0x18dfb5(0x214)](_0x32178b):null;}[_0xd6163d(0x1e2)](){const _0x163724=_0xd6163d;return localStorage[_0x163724(0x224)]('pegasus_token');}[_0xd6163d(0x238)](){const _0x55cce8=_0xd6163d;localStorage[_0x55cce8(0x1d6)](_0x55cce8(0x207)),localStorage['removeItem'](_0x55cce8(0x225)),localStorage[_0x55cce8(0x1d6)]('pegasus_expiration'),this[_0x55cce8(0x200)](),window['location'][_0x55cce8(0x21d)]='index.html';}[_0xd6163d(0x200)](){const _0x24c1a9=_0xd6163d;this[_0x24c1a9(0x236)](),this[_0x24c1a9(0x1da)]();}['updateDesktopAuthUI'](){const _0x4004f8=_0xd6163d,_0x42d6ff=document[_0x4004f8(0x1d4)]('.auth-buttons');if(this['isAuthenticated']()){const _0x11f430=this[_0x4004f8(0x208)]();if(_0x42d6ff){_0x42d6ff[_0x4004f8(0x216)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-menu\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22user-btn\x22\x20id=\x22user-menu-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22user-avatar\x22>'+_0x11f430[_0x4004f8(0x1dd)][_0x4004f8(0x203)](0x0)[_0x4004f8(0x204)]()+_0x4004f8(0x1f7)+_0x11f430[_0x4004f8(0x1dd)]+_0x4004f8(0x1ef)+(_0x11f430[_0x4004f8(0x1ca)]===_0x4004f8(0x227)?_0x4004f8(0x209):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22#\x22\x20id=\x22logout-btn\x22><i\x20class=\x22fas\x20fa-sign-out-alt\x22></i>\x20Logout</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x1dd002=document[_0x4004f8(0x1ec)](_0x4004f8(0x221)),_0x48820d=document[_0x4004f8(0x1ec)]('user-menu-btn'),_0x999d97=document[_0x4004f8(0x1ec)]('user-dropdown');_0x1dd002&&_0x1dd002['addEventListener'](_0x4004f8(0x211),_0x244c51=>{const _0x1e3902=_0x4004f8;_0x244c51[_0x1e3902(0x22a)](),this[_0x1e3902(0x238)]();}),_0x48820d&&_0x999d97&&(_0x48820d[_0x4004f8(0x1fa)]('click',()=>{const _0x3e7afa=_0x4004f8;_0x999d97['classList'][_0x3e7afa(0x217)](_0x3e7afa(0x1f8));}),document[_0x4004f8(0x1fa)](_0x4004f8(0x211),_0x451963=>{const _0x34505d=_0x4004f8;!_0x48820d[_0x34505d(0x1e7)](_0x451963[_0x34505d(0x1f6)])&&!_0x999d97[_0x34505d(0x1e7)](_0x451963[_0x34505d(0x1f6)])&&_0x999d97[_0x34505d(0x1fe)][_0x34505d(0x237)](_0x34505d(0x1f8));}));}}else _0x42d6ff&&(_0x42d6ff[_0x4004f8(0x216)]=_0x4004f8(0x212));}[_0xd6163d(0x1da)](){const _0x1934ec=_0xd6163d,_0x5b08a2=document[_0x1934ec(0x1d4)](_0x1934ec(0x1e0));if(!_0x5b08a2)return;if(this[_0x1934ec(0x231)]()){const _0x19e2eb=this['getCurrentUser']();_0x5b08a2[_0x1934ec(0x216)]=_0x1934ec(0x1fb)+(_0x19e2eb['role']===_0x1934ec(0x227)?_0x1934ec(0x20a):'')+_0x1934ec(0x202);const _0x51aaf4=document[_0x1934ec(0x1ec)]('mobile-logout-btn');_0x51aaf4&&_0x51aaf4[_0x1934ec(0x1fa)](_0x1934ec(0x211),()=>{this['signOut']();});}else _0x5b08a2[_0x1934ec(0x216)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22signin.html\x22\x20class=\x22btn\x20btn-outline\x22>Sign\x20In</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22signup.html\x22\x20class=\x22btn\x20subscribe-btn\x22>Subscribe</a>\x0a\x20\x20\x20\x20\x20\x20';}async['checkAuthStatus'](){const _0x12fd33=_0xd6163d;if(!this[_0x12fd33(0x231)]())return![];try{const _0x1ad445=this[_0x12fd33(0x1e2)](),_0x25e904=await fetch(this[_0x12fd33(0x1f1)]+_0x12fd33(0x1ed),{'headers':{'Authorization':_0x12fd33(0x22e)+_0x1ad445}});if(_0x25e904[_0x12fd33(0x1d2)]===0x191)return this[_0x12fd33(0x238)](),![];return _0x25e904['ok'];}catch(_0x24a0d9){return console[_0x12fd33(0x1ee)](_0x12fd33(0x201),_0x24a0d9),![];}}async[_0xd6163d(0x1e8)](_0xe2e35b,_0x31225e){const _0x552ad2=_0xd6163d;try{const _0x68b54b=this[_0x552ad2(0x1e2)]();if(!_0x68b54b)return{'success':![],'error':_0x552ad2(0x22b)};const _0x4d43bf=await fetch(this[_0x552ad2(0x1f1)]+_0x552ad2(0x1f9),{'method':_0x552ad2(0x1d5),'headers':{'Content-Type':_0x552ad2(0x218),'Authorization':_0x552ad2(0x22e)+_0x68b54b},'body':JSON[_0x552ad2(0x1f0)]({'contentId':_0xe2e35b,'contentType':_0x31225e})});if(_0x4d43bf['ok']){const _0x7fc98f=await _0x4d43bf[_0x552ad2(0x215)]();return{'success':!![],'favoriteId':_0x7fc98f[_0x552ad2(0x234)]};}else{const _0x5f03c7=await _0x4d43bf[_0x552ad2(0x215)]();return{'success':![],'error':_0x5f03c7[_0x552ad2(0x1ee)]||_0x552ad2(0x1f5)};}}catch(_0x76565b){return{'success':![],'error':_0x552ad2(0x21b)+_0x76565b[_0x552ad2(0x1d9)]};}}async['removeFromFavorites'](_0x230e27){const _0x17735f=_0xd6163d;try{const _0x5b2155=this[_0x17735f(0x1e2)]();if(!_0x5b2155)return{'success':![],'error':_0x17735f(0x22b)};const _0x2747e9=await fetch(this['API_BASE']+'/api/favorites/'+_0x230e27,{'method':_0x17735f(0x220),'headers':{'Authorization':'Bearer\x20'+_0x5b2155}});if(_0x2747e9['ok'])return{'success':!![]};else{const _0x178957=await _0x2747e9[_0x17735f(0x215)]();return{'success':![],'error':_0x178957['error']||_0x17735f(0x1ff)};}}catch(_0x1892a8){return{'success':![],'error':_0x17735f(0x21b)+_0x1892a8[_0x17735f(0x1d9)]};}}async[_0xd6163d(0x206)](_0xc19253,_0x435c11){const _0x34ae4e=_0xd6163d;try{const _0x52f423=this[_0x34ae4e(0x1e2)]();if(!_0x52f423)return{'success':![],'isFavorited':![]};const _0x4dd494=await fetch(this[_0x34ae4e(0x1f1)]+_0x34ae4e(0x223)+_0xc19253+_0x34ae4e(0x213)+_0x435c11,{'headers':{'Authorization':'Bearer\x20'+_0x52f423}});if(_0x4dd494['ok']){const _0x27ffcc=await _0x4dd494[_0x34ae4e(0x215)]();return{'success':!![],..._0x27ffcc};}else return{'success':![],'isFavorited':![]};}catch(_0x53caaa){return{'success':![],'isFavorited':![]};}}async['getFavorites'](){const _0x27fd44=_0xd6163d;try{const _0x2d01a2=this[_0x27fd44(0x1e2)]();if(!_0x2d01a2)return{'success':![],'favorites':[]};const _0x537fbc=await fetch(this['API_BASE']+_0x27fd44(0x1f9),{'headers':{'Authorization':_0x27fd44(0x22e)+_0x2d01a2}});if(_0x537fbc['ok']){const _0x1d41f6=await _0x537fbc[_0x27fd44(0x215)]();return{'success':!![],'favorites':_0x1d41f6[_0x27fd44(0x1d1)]||[]};}else return{'success':![],'favorites':[]};}catch(_0x404e7a){return{'success':![],'favorites':[]};}}async[_0xd6163d(0x1f2)](_0x3f89bc,_0x45eeaf){const _0xf8801d=_0xd6163d;try{const _0x14a48a=await fetch(this['API_BASE']+_0xf8801d(0x229)+_0x3f89bc+_0xf8801d(0x213)+_0x45eeaf);if(_0x14a48a['ok']){const _0x301eb5=await _0x14a48a[_0xf8801d(0x215)]();return{'success':!![],'comments':_0x301eb5};}else return{'success':![],'comments':[]};}catch(_0x3d4c70){return{'success':![],'comments':[]};}}async[_0xd6163d(0x228)](_0x13081a,_0x462214,_0x5c87a5){const _0x41b2d3=_0xd6163d;try{const _0x57704f=this[_0x41b2d3(0x1e2)]();if(!_0x57704f)return{'success':![],'error':'Not\x20authenticated'};const _0x16c107=await fetch(this[_0x41b2d3(0x1f1)]+'/api/comments',{'method':_0x41b2d3(0x1d5),'headers':{'Content-Type':'application/json','Authorization':_0x41b2d3(0x22e)+_0x57704f},'body':JSON[_0x41b2d3(0x1f0)]({'contentId':_0x13081a,'contentType':_0x462214,'comment':_0x5c87a5})});if(_0x16c107['ok']){const _0x1ba78d=await _0x16c107['json']();return{'success':!![],'comment':_0x1ba78d};}else{const _0x2637f4=await _0x16c107[_0x41b2d3(0x215)]();return{'success':![],'error':_0x2637f4[_0x41b2d3(0x1ee)]||_0x41b2d3(0x235)};}}catch(_0x3da7f4){return{'success':![],'error':'Network\x20error:\x20'+_0x3da7f4[_0x41b2d3(0x1d9)]};}}}document[_0xd6163d(0x1fa)]('DOMContentLoaded',()=>{const _0x4475c9=_0xd6163d;try{!window[_0x4475c9(0x1db)]&&(console[_0x4475c9(0x1cd)](_0x4475c9(0x233)),window[_0x4475c9(0x1db)]={'API_BASE':_0x4475c9(0x1eb),'JWT_SECRET':'pegasus-super-secret-key-change-in-production','APP_VERSION':_0x4475c9(0x1de)}),window['authManager']=new AuthManager();}catch(_0x43d092){console[_0x4475c9(0x1ee)](_0x4475c9(0x22f),_0x43d092);}});
